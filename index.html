<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airdrop Vault</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            /* Palette iOS 18 Liquid */
            --primary-grad: linear-gradient(135deg, #3b82f6, #06b6d4); /* Biru ke Cyan */
            --glass-bg-main: rgba(255, 255, 255, 0.15); /* Sangat transparan */
            --glass-bg-input: rgba(255, 255, 255, 0.08);
            --glass-bg-card: rgba(255, 255, 255, 0.2);
            --glass-border: rgba(255, 255, 255, 0.25);
            --glass-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            
            --text-light: #ffffff;
            --text-dim: #cbd5e1;
            --danger: #ef4444;
            --danger-glass: rgba(239, 68, 68, 0.2);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }

        body {
            min-height: 100vh;
            display: flex; justify-content: center; align-items: center; padding: 20px;
            background-color: #0f172a; /* Warna dasar gelap */
            
            /* --- LIQUID MESH BACKGROUND --- */
            /* Ini menciptakan efek cairan bergerak dengan banyak lapisan warna */
            background-image: 
                radial-gradient(at 10% 20%, hsla(215, 98%, 61%, 0.6) 0px, transparent 50%),
                radial-gradient(at 90% 80%, hsla(190, 100%, 50%, 0.6) 0px, transparent 50%),
                radial-gradient(at 50% 50%, hsla(258, 90%, 66%, 0.4) 0px, transparent 50%),
                radial-gradient(at 80% 10%, hsla(340, 100%, 76%, 0.4) 0px, transparent 50%),
                radial-gradient(at 20% 90%, hsla(200, 100%, 50%, 0.5) 0px, transparent 50%);
            background-size: 180% 180%;
            animation: liquidFlow 25s ease infinite alternate;
        }

        @keyframes liquidFlow {
            0% { background-position: 0% 0%; }
            100% { background-position: 100% 100%; }
        }

        .container {
            width: 100%; max-width: 800px;
            /* --- MAIN GLASS CARD --- */
            background: var(--glass-bg-main);
            /* Efek blur sangat kuat + saturasi tinggi agar warna di belakang 'pop' */
            backdrop-filter: blur(50px) saturate(150%);
            -webkit-backdrop-filter: blur(50px) saturate(150%);
            border: 1px solid var(--glass-border);
            border-radius: 36px;
            padding: 40px;
            box-shadow: var(--glass-shadow), inset 0 0 0 1px rgba(255,255,255,0.1);
        }

        /* HEADER */
        header { text-align: center; margin-bottom: 35px; color: var(--text-light); }
        .logo-box {
            width: 64px; height: 64px; margin: 0 auto 15px;
            background: var(--primary-grad); border-radius: 20px;
            display: flex; align-items: center; justify-content: center;
            font-size: 28px; box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.5);
        }
        h1 { font-size: 26px; font-weight: 700; letter-spacing: -0.5px; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        p { color: var(--text-dim); margin-top: 8px; }

        /* FORM */
        .input-group { margin-bottom: 30px; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .full-width { grid-column: span 2; }

        label { 
            display: block; font-size: 13px; font-weight: 500; color: var(--text-dim); 
            margin-bottom: 10px; margin-left: 5px;
        }

        input, select {
            width: 100%; padding: 16px;
            /* Input adalah "lubang kaca" yang lebih gelap */
            background: var(--glass-bg-input);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            color: var(--text-light); font-size: 15px; outline: none;
            transition: 0.3s;
        }
        input::placeholder { color: rgba(255,255,255,0.4); }
        input:focus, select:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(59, 130, 246, 0.5);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
        }
        select { appearance: none; background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 15px center; background-size: 16px; }

        .btn-save {
            width: 100%; padding: 18px; margin-top: 10px;
            background: var(--primary-grad);
            color: white; font-weight: 700; font-size: 16px;
            border: none; border-radius: 20px; cursor: pointer;
            box-shadow: 0 15px 30px -10px rgba(59, 130, 246, 0.6);
            transition: 0.3s;
        }
        .btn-save:hover { transform: translateY(-3px); box-shadow: 0 20px 40px -10px rgba(59, 130, 246, 0.8); }

        /* LIST SECTION */
        .section-header {
            display: flex; justify-content: space-between; align-items: center;
            margin: 40px 0 20px; padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .section-title { font-size: 18px; font-weight: 600; color: var(--text-light); }
        .badge-count { background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 30px; color: var(--text-dim); font-size: 13px; }

        .grid-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }

        .card {
            /* Kartu list lebih terang daripada background utama */
            background: var(--glass-bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            padding: 20px;
            transition: 0.3s;
            display: flex; flex-direction: column;
        }
        .card:hover { 
            transform: translateY(-5px); 
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 15px 35px -10px rgba(0,0,0,0.3);
        }

        .card-top { display: flex; justify-content: space-between; margin-bottom: 12px; }
        .keyword-pill { background: rgba(59, 130, 246, 0.2); color: #60a5fa; padding: 6px 12px; border-radius: 12px; font-size: 11px; font-weight: 600; }
        .status-dot { height: 8px; width: 8px; border-radius: 50%; display: inline-block; margin-right: 6px; }
        .st-Active { background: #22c55e; box-shadow: 0 0 10px #22c55e; }
        .st-Done { background: #94a3b8; }

        .card h3 { color: var(--text-light); margin-bottom: 8px; font-size: 17px; }
        .source { color: var(--text-dim); font-size: 13px; flex-grow: 1; margin-bottom: 25px; }

        /* ACTION ROW (TOMBOL SEJAJAR) */
        .action-row { display: flex; gap: 12px; }
        .btn-link {
            flex: 1; text-decoration: none; text-align: center;
            background: rgba(255, 255, 255, 0.1); color: var(--text-light);
            padding: 14px; border-radius: 16px; font-weight: 600; font-size: 14px;
            transition: 0.3s; border: 1px solid rgba(255,255,255,0.1);
        }
        .btn-link:hover { background: rgba(255, 255, 255, 0.2); border-color: rgba(255,255,255,0.3); }
        
        .btn-delete {
            width: 48px; height: 48px; flex-shrink: 0;
            background: var(--danger-glass); color: #f87171;
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 16px; font-size: 18px; cursor: pointer;
            display: flex; align-items: center; justify-content: center; transition: 0.3s;
        }
        .btn-delete:hover { background: rgba(239, 68, 68, 0.4); transform: scale(1.05); }

        /* RESPONSIVE */
        @media (max-width: 600px) {
            .form-grid { grid-template-columns: 1fr; }
            .full-width { grid-column: span 1; }
            .container { padding: 25px; border-radius: 28px; }
            body { padding: 15px; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="logo-box"><i class="fas fa-layer-group"></i></div>
        <h1>Airdrop Vault Delonix</h1>
        <p>Managed by Private Bot</p>
    </header>

    <div class="input-group">
        <form id="addForm">
            <div class="form-grid">
                <div class="full-width">
                    <label>Nama Project</label>
                    <input type="text" id="name" placeholder="Contoh: Avon Public Testnet" required>
                </div>
                <div>
                    <label>Keyword Bot</label>
                    <input type="text" id="keyword" placeholder="Contoh: Avon" required>
                </div>
                <div>
                    <label>Source ID</label>
                    <input type="text" id="source" placeholder="airdropfinder" required>
                </div>
                <div class="full-width">
                    <label>Link Garapan</label>
                    <input type="url" id="link" placeholder="https://..." required>
                </div>
                <div class="full-width">
                    <label>Status</label>
                    <select id="status">
                        <option value="Active" style="color:black">Active (Tracking)</option>
                        <option value="Done" style="color:black">Done (Arsip)</option>
                    </select>
                </div>
            </div>
            <button type="submit" class="btn-save">Simpan Data</button>
        </form>
    </div>

    <div class="section-header">
        <span class="section-title">Monitoring List</span>
        <span class="badge-count" id="totalCount">0 Items</span>
    </div>
    
    <div id="gridList" class="grid-list">
        <div style="grid-column:1/-1; text-align:center; padding:40px; color:var(--text-dim);">
            <i class="fas fa-circle-notch fa-spin"></i> Menghubungkan...
        </div>
    </div>
</div>

<script type="module">
    // --- CONFIG FIREBASE (JANGAN LUPA ISI API KEY) ---
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getFirestore, collection, addDoc, deleteDoc, doc, onSnapshot, query, orderBy } 
    from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDJwLno6mR7X1MNHyn3gRYagduOohmgcWQ",
  authDomain: "cryptodelonix.firebaseapp.com",
  projectId: "cryptodelonix",
  storageBucket: "cryptodelonix.firebasestorage.app",
  messagingSenderId: "265190187840",
  appId: "1:265190187840:web:86be6be1e4eac1aa70d0a5",
  measurementId: "G-BSSFE27WZ5"
};

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // --- RENDER DATA ---
    const q = query(collection(db, "airdrops"), orderBy("createdAt", "desc"));
    
    onSnapshot(q, (snapshot) => {
        const grid = document.getElementById('gridList');
        const badge = document.getElementById('totalCount');
        
        grid.innerHTML = ""; badge.innerText = snapshot.size + " Items";

        if(snapshot.empty){
            grid.innerHTML = `<div style="grid-column:1/-1; text-align:center; padding:40px; color:var(--text-dim);">Belum ada data.</div>`;
            return;
        }

        snapshot.forEach((documentSnapshot) => {
            const data = documentSnapshot.data();
            const docId = documentSnapshot.id;
            const searchKey = data.search_keyword || data.name;

            const card = document.createElement('div');
            card.className = 'card';
            
            card.innerHTML = `
                <div class="card-top">
                    <span class="keyword-pill"><i class="fas fa-search"></i> ${searchKey}</span>
                    <div style="font-size:12px; color:${data.status === 'Active'?'#22c55e':'#94a3b8'}">
                        <span class="status-dot ${data.status === 'Active'?'st-Active':'st-Done'}"></span>${data.status}
                    </div>
                </div>
                
                <h3>${data.name}</h3>
                <div class="source"><i class="fab fa-telegram-plane"></i> @${data.source}</div>
                
                <div class="action-row">
                    <a href="${data.link}" target="_blank" class="btn-link">Buka Link</a>
                    </div>
            `;

            const delBtn = document.createElement('button');
            delBtn.className = 'btn-delete';
            delBtn.innerHTML = '<i class="far fa-trash-alt"></i>';
            delBtn.onclick = async () => {
                if(confirm(`Hapus ${data.name}?`)) await deleteDoc(doc(db, "airdrops", docId));
            };

            card.querySelector('.action-row').appendChild(delBtn);
            grid.appendChild(card);
        });
    });

    // --- SUBMIT ---
    document.getElementById('addForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const btn = document.querySelector('.btn-save');
        const originalText = btn.innerText;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Menyimpan...'; btn.disabled = true;

        try {
            await addDoc(collection(db, "airdrops"), {
                name: document.getElementById('name').value,
                search_keyword: document.getElementById('keyword').value.trim(),
                source: document.getElementById('source').value.replace('@','').trim(),
                link: document.getElementById('link').value,
                status: document.getElementById('status').value,
                createdAt: new Date(),
                last_message_snippet: "", tracked_msg_id: null 
            });
            e.target.reset();
        } catch(err) { alert(err.message); }

        btn.innerText = originalText; btn.disabled = false;
    });
</script>

</body>
</html>
